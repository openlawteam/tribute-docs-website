"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7651],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return h}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),d=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=d(n),h=r,k=p["".concat(s,".").concat(h)]||p[h]||u[h]||i;return n?a.createElement(k,o(o({ref:t},c),{},{components:n})):a.createElement(k,o({ref:t},c))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var d=2;d<i;d++)o[d]=n[d];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},5002:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return d},toc:function(){return c},default:function(){return p}});var a=n(7462),r=n(3366),i=(n(7294),n(3905)),o=["components"],l={id:"bank-adapter",title:"Bank"},s=void 0,d={unversionedId:"contracts/adapters/utils/bank-adapter",id:"contracts/adapters/utils/bank-adapter",isDocsHomePage:!1,title:"Bank",description:"The Bank adapter is an utility adapter that allows withdraws, and token balance updates.",source:"@site/docs/contracts/adapters/utils/Bank.md",sourceDirName:"contracts/adapters/utils",slug:"/contracts/adapters/utils/bank-adapter",permalink:"/docs/contracts/adapters/utils/bank-adapter",editUrl:"https://github.com/openlawteam/tribute-contracts/edit/docs/website/docs/contracts/adapters/utils/Bank.md",tags:[],version:"current",frontMatter:{id:"bank-adapter",title:"Bank"},sidebar:"docs",previous:{title:"Offchain",permalink:"/docs/contracts/adapters/voting/offchain-voting-adapter"},next:{title:"NFT",permalink:"/docs/contracts/adapters/utils/nft-adapter"}},c=[{value:"Workflow",id:"workflow",children:[{value:"Withdraw",id:"withdraw",children:[]},{value:"Balance Update",id:"balance-update",children:[]}]},{value:"Access Flags",id:"access-flags",children:[{value:"BankExtension",id:"bankextension",children:[]}]},{value:"Dependencies",id:"dependencies",children:[{value:"DaoRegistry",id:"daoregistry",children:[]},{value:"ERC20",id:"erc20",children:[]},{value:"BankExtension",id:"bankextension-1",children:[]}]},{value:"Structs",id:"structs",children:[]},{value:"Storage",id:"storage",children:[]},{value:"Functions",id:"functions",children:[{value:"receive",id:"receive",children:[]},{value:"withdraw",id:"withdraw-1",children:[]},{value:"updateToken",id:"updatetoken",children:[]}]},{value:"Events",id:"events",children:[{value:"Withdraw",id:"withdraw-2",children:[]},{value:"NewBalance",id:"newbalance",children:[]}]}],u={toc:c};function p(e){var t=e.components,n=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"The Bank adapter is an utility adapter that allows withdraws, and token balance updates."),(0,i.kt)("p",null,"It is considered a Generic adapter because it does not rely on any proposals to perform an action that changes the DAO state."),(0,i.kt)("h2",{id:"workflow"},"Workflow"),(0,i.kt)("h3",{id:"withdraw"},"Withdraw"),(0,i.kt)("p",null,"The user sends a transaction to withdraw the funds from the internal bank account. If there are no available funds, the transaction is reverted. If the user is using an address that is reserved to the DAO, the transaction is also reverted. And when the user provides a token that is not supported by the bank, the balance is always zero and the transaction gets reverted as well."),(0,i.kt)("p",null,"If all the parameters are valid, the user should be able to identify the funds transferred to its own account."),(0,i.kt)("h3",{id:"balance-update"},"Balance Update"),(0,i.kt)("p",null,"The Bank calculates the balance for a given token, and updates its internal records."),(0,i.kt)("h2",{id:"access-flags"},"Access Flags"),(0,i.kt)("h3",{id:"bankextension"},"BankExtension"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"WITHDRAW")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"SUB_FROM_BALANCE")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"UPDATE_TOKEN"))),(0,i.kt)("h2",{id:"dependencies"},"Dependencies"),(0,i.kt)("h3",{id:"daoregistry"},"DaoRegistry"),(0,i.kt)("h3",{id:"erc20"},"ERC20"),(0,i.kt)("h3",{id:"bankextension-1"},"BankExtension"),(0,i.kt)("h2",{id:"structs"},"Structs"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"There are no structures.")),(0,i.kt)("h2",{id:"storage"},"Storage"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The adapter does not keep track of any state.")),(0,i.kt)("h2",{id:"functions"},"Functions"),(0,i.kt)("h3",{id:"receive"},"receive"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-solidity"},"    /**\n     * @notice default fallback function to prevent from sending ether to the contract.\n     */\n    receive() external payable\n")),(0,i.kt)("h3",{id:"withdraw-1"},"withdraw"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-solidity"},"     /**\n     * @notice Allows the member/advisor of the DAO to withdraw the funds from their internal bank account.\n     * @notice Only accounts that are not reserved can withdraw the funds.\n     * @notice If theres is no available balance in the user's account, the transaction is reverted.\n     * @param dao The DAO address.\n     * @param account The account to receive the funds.\n     * @param token The token address to receive the funds.\n     */\n    function withdraw(\n        DaoRegistry dao,\n        address payable account,\n        address token\n    ) external reentrancyGuard(dao)\n")),(0,i.kt)("h3",{id:"updatetoken"},"updateToken"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-solidity"},"    /**\n     * @notice Allows anyone to update the token balance in the bank extension\n     * @notice If theres is no available balance in the user's account, the transaction is reverted.\n     * @param dao The DAO address.\n     * @param token The token address to update.\n     */\n    function updateToken(DaoRegistry dao, address token)\n        external\n        reentrancyGuard(dao)\n")),(0,i.kt)("h2",{id:"events"},"Events"),(0,i.kt)("h3",{id:"withdraw-2"},"Withdraw"),(0,i.kt)("p",null,"When a member executes an withdraw."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"event Withdraw(address account, address tokenAddr, uint160 amount);"))),(0,i.kt)("h3",{id:"newbalance"},"NewBalance"),(0,i.kt)("p",null,"When the token balance is updated in the Bank."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"emit NewBalance(member, token, newAmount);"))))}p.isMDXComponent=!0}}]);