"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1951],{3905:function(e,n,t){t.d(n,{Zo:function(){return l},kt:function(){return h}});var a=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function d(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),c=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},l=function(e){var n=c(e.components);return a.createElement(s.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,l=d(e,["components","mdxType","originalType","parentName"]),m=c(t),h=r,p=m["".concat(s,".").concat(h)]||m[h]||u[h]||o;return t?a.createElement(p,i(i({ref:n},l),{},{components:t})):a.createElement(p,i({ref:n},l))}));function h(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=t.length,i=new Array(o);i[0]=m;var d={};for(var s in n)hasOwnProperty.call(n,s)&&(d[s]=n[s]);d.originalType=e,d.mdxType="string"==typeof e?e:r,i[1]=d;for(var c=2;c<o;c++)i[c]=t[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},9955:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return d},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return l},default:function(){return m}});var a=t(7462),r=t(3366),o=(t(7294),t(3905)),i=["components"],d={id:"kyc-onboarding-adapter",title:"KYC ERC20/ETH"},s=void 0,c={unversionedId:"contracts/adapters/onboarding/kyc-onboarding-adapter",id:"contracts/adapters/onboarding/kyc-onboarding-adapter",isDocsHomePage:!1,title:"KYC ERC20/ETH",description:"The KYC Onboarding adapter is a mix between Coupon onboarding and Onboarding adapter.",source:"@site/docs/contracts/adapters/onboarding/KycOnboarding.md",sourceDirName:"contracts/adapters/onboarding",slug:"/contracts/adapters/onboarding/kyc-onboarding-adapter",permalink:"/docs/contracts/adapters/onboarding/kyc-onboarding-adapter",editUrl:"https://github.com/openlawteam/tribute-contracts/edit/docs/website/docs/contracts/adapters/onboarding/KycOnboarding.md",tags:[],version:"current",frontMatter:{id:"kyc-onboarding-adapter",title:"KYC ERC20/ETH"},sidebar:"docs",previous:{title:"ERC721/1155 Lending / Staking",permalink:"/docs/contracts/adapters/onboarding/lend-nft-adapter"},next:{title:"Basic",permalink:"/docs/contracts/adapters/voting/basic-voting-adapter"}},l=[{value:"Workflow",id:"workflow",children:[]},{value:"Access Flags",id:"access-flags",children:[{value:"DaoRegistry",id:"daoregistry",children:[]},{value:"BankExtension",id:"bankextension",children:[]}]},{value:"Dependencies",id:"dependencies",children:[{value:"DaoRegistry",id:"daoregistry-1",children:[]},{value:"BankExtension",id:"bankextension-1",children:[]},{value:"Voting",id:"voting",children:[]},{value:"IERC20",id:"ierc20",children:[]},{value:"PotentialNewMember",id:"potentialnewmember",children:[]},{value:"ERC20",id:"erc20",children:[]}]},{value:"Structs",id:"structs",children:[{value:"Coupon",id:"coupon",children:[]},{value:"OnboardingDetails",id:"onboardingdetails",children:[]}]},{value:"Storage",id:"storage",children:[{value:"units",id:"units",children:[]}]},{value:"Functions",id:"functions",children:[{value:"configureDao",id:"configuredao",children:[]},{value:"hashCouponMessage",id:"hashcouponmessage",children:[]},{value:"onboardEth",id:"onboardeth",children:[]},{value:"onboard",id:"onboard",children:[]},{value:"_onboard",id:"_onboard",children:[]},{value:"_checkData",id:"_checkdata",children:[]},{value:"_checkKycCoupon",id:"_checkkyccoupon",children:[]},{value:"_configKey",id:"_configkey",children:[]},{value:"Events",id:"events",children:[]},{value:"Onboarded",id:"onboarded",children:[]}]}],u={toc:l};function m(e){var n=e.components,t=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"The KYC Onboarding adapter is a mix between Coupon onboarding and Onboarding adapter."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Like with Coupon Onboarding, there is no proposals involved in the onboarding process."),(0,o.kt)("li",{parentName:"ul"},"Like with Coupon Onboarding, an attestation (in this case, that you have been KYCed) has to be provided."),(0,o.kt)("li",{parentName:"ul"},"Like with Onboarding, the number of internal tokens minted is linked to the amount contributed.")),(0,o.kt)("p",null,"The only difference between Kyc Onboarding and the two others is that if configured, the funds won't go to the bank but instead directly to an external address."),(0,o.kt)("h2",{id:"workflow"},"Workflow"),(0,o.kt)("p",null,"To join the DAO, any member needs to first get KYCed and then contribute the right amount to get his UNITS.\nA member can use KYCOnboarding only once, i.e. if he is already a member he cannot use it."),(0,o.kt)("p",null,"There is no proposal involved here, i.e. if you are eligible to become a member you can join automatically."),(0,o.kt)("h2",{id:"access-flags"},"Access Flags"),(0,o.kt)("h3",{id:"daoregistry"},"DaoRegistry"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"UPDATE_DELEGATE_KEY")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"NEW_MEMBER"))),(0,o.kt)("h3",{id:"bankextension"},"BankExtension"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"ADD_TO_BALANCE"))),(0,o.kt)("h2",{id:"dependencies"},"Dependencies"),(0,o.kt)("h3",{id:"daoregistry-1"},"DaoRegistry"),(0,o.kt)("h3",{id:"bankextension-1"},"BankExtension"),(0,o.kt)("h3",{id:"voting"},"Voting"),(0,o.kt)("h3",{id:"ierc20"},"IERC20"),(0,o.kt)("h3",{id:"potentialnewmember"},"PotentialNewMember"),(0,o.kt)("h3",{id:"erc20"},"ERC20"),(0,o.kt)("h2",{id:"structs"},"Structs"),(0,o.kt)("h3",{id:"coupon"},"Coupon"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"kycedMember"),": The address of the member that has been verified, and is allowed to redeem a coupon to join the DAO.")),(0,o.kt)("h3",{id:"onboardingdetails"},"OnboardingDetails"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"chunkSize"),": How many tokens need to be minted per chunk bought."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"numberOfChunks"),": How many chunks need to be created based on the contribution."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unitsPerChunk"),": How many units (tokens from tokenAddr) are being minted per chunk."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unitsRequested"),": which internal token to mint"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"amount"),": the amount of internal tokens minted"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"maximumTotalUnits"),": How many internal tokens can be minted")),(0,o.kt)("h2",{id:"storage"},"Storage"),(0,o.kt)("h3",{id:"units"},"units"),(0,o.kt)("p",null,"Accounting to see the amount of a particular internal token that has been minted for a particular applicant. This is then checked against the maxChunks configuration to determine if the onboarding proposal is allowed or not."),(0,o.kt)("h2",{id:"functions"},"Functions"),(0,o.kt)("h3",{id:"configuredao"},"configureDao"),(0,o.kt)("p",null,"Configures the adapter for a particular DAO. The modifier is adapterOnly which means that only if the sender is either a registered adapter of the DAO or if it is in creation mode can it be called. The function checks that chunkSize, unitsPerChunks and maximumChunks cannot be 0."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n     * @notice Configures the Adapter with the coupon signer address and token to mint.\n     * @param dao the dao to configure\n     * @param signerAddress is the DAO instance to be configured\n     * @param chunkSize how many wei per chunk\n     * @param unitsPerChunk how many units do we get per chunk\n     * @param maximumChunks maximum number of chunks allowed\n     * @param maxUnits how many internal tokens can be minted\n     * @param maxMembers maximum number of members allowed to join\n     * @param fundTargetAddress multisig address to transfer the money from, set it to address(0) if you dont want to use a multisig\n     * @param tokenAddr the token in which the onboarding can take place\n     * @param internalTokensToMint the token that will be minted when the member joins the DAO\n     */\n    function configureDao(\n        DaoRegistry dao,\n        address signerAddress,\n        uint256 chunkSize,\n        uint256 unitsPerChunk,\n        uint256 maximumChunks,\n        uint256 maxUnits,\n        uint256 maxMembers,\n        address fundTargetAddress,\n        address tokenAddr,\n        address internalTokensToMint\n    ) external onlyAdapter(dao)\n")),(0,o.kt)("h3",{id:"hashcouponmessage"},"hashCouponMessage"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n     * @notice Hashes the provided coupon as an ERC712 hash.\n     * @param dao is the DAO instance to be configured\n     * @param coupon is the coupon to hash\n     */\n    function hashCouponMessage(DaoRegistry dao, Coupon memory coupon)\n        public\n        view\n        returns (bytes32)\n")),(0,o.kt)("h3",{id:"onboardeth"},"onboardEth"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-solidity"},"    /**\n     * @notice Starts the onboarding propocess of a kyc member that is using ETH to join the DAO.\n     * @param kycedMember The address of the kyced member that wants to join the DAO.\n     * @param signature The signature that will be verified to redeem the coupon.\n     */\n    function onboardEth(\n        DaoRegistry dao,\n        address kycedMember,\n        bytes memory signature\n    ) external payable\n")),(0,o.kt)("h3",{id:"onboard"},"onboard"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-solidity"},"    /**\n     * @notice Starts the onboarding process of a kyc member that is any ERC20 token to join the DAO.\n     * @param kycedMember The address of the kyced member that wants to join the DAO.\n     * @param tokenAddr The address of the ERC20 token that contains that funds of the kycedMember.\n     * @param amount The amount in ERC20 that will be contributed to the DAO in exchange for the DAO units.\n     * @param signature The signature that will be verified to redeem the coupon.\n     */\n    function onboard(\n        DaoRegistry dao,\n        address kycedMember,\n        address tokenAddr,\n        uint256 amount,\n        bytes memory signature\n    ) external\n")),(0,o.kt)("h3",{id:"_onboard"},"_","onboard"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n     * @notice Redeems a coupon to add a new member\n     * @param dao is the DAO instance to be configured\n     * @param kycedMember is the address that this coupon authorized to become a new member\n     * @param tokenAddr is the address the ETH address(0) or an ERC20 Token address\n     * @param signature is message signature for verification\n     */\n    function _onboard(\n        DaoRegistry dao,\n        address kycedMember,\n        address tokenAddr,\n        uint256 amount,\n        bytes memory signature\n    ) internal reentrancyGuard(dao)\n")),(0,o.kt)("h3",{id:"_checkdata"},"_","checkData"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n     * @notice Verifies if the given amount is enough to join the DAO\n     */\n    function _checkData(\n        DaoRegistry dao,\n        address tokenAddr,\n        uint256 amount\n    ) internal view returns (OnboardingDetails memory details)\n")),(0,o.kt)("h3",{id:"_checkkyccoupon"},"_","checkKycCoupon"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n     * @notice Checks if the given signature is valid, if so the member is allowed to reedem the coupon and join the DAO.\n     * @param kycedMember is the address that this coupon authorized to become a new member\n     * @param tokenAddr is the address the ETH address(0) or an ERC20 Token address.\n     * @param signature is message signature for verification\n     */\n    function _checkKycCoupon(\n        DaoRegistry dao,\n        address kycedMember,\n        address tokenAddr,\n        bytes memory signature\n    ) internal view\n")),(0,o.kt)("h3",{id:"_configkey"},"_","configKey"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-solidity"},"/**\n     * @notice Builds the configuration key by encoding an address with a string key.\n     * @param tokenAddrToMint The address to encode.\n     * @param key The key to encode.\n     */\n    function _configKey(address tokenAddrToMint, bytes32 key)\n        internal\n        pure\n        returns (bytes32)\n")),(0,o.kt)("h3",{id:"events"},"Events"),(0,o.kt)("h3",{id:"onboarded"},"Onboarded"),(0,o.kt)("p",null,"When the onboarding process is completed the ",(0,o.kt)("inlineCode",{parentName:"p"},"Onboarded")," event is emitted with the ",(0,o.kt)("inlineCode",{parentName:"p"},"dao")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"member")," addresses, and ",(0,o.kt)("inlineCode",{parentName:"p"},"amount")," of units minted to the new member."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"event Onboarded(DaoRegistry dao, address member, uint256 units);"))))}m.isMDXComponent=!0}}]);