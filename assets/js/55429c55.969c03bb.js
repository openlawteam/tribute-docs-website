"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4361],{3905:function(e,t,a){a.d(t,{Zo:function(){return p},kt:function(){return m}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var d=n.createContext({}),l=function(e){var t=n.useContext(d),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},p=function(e){var t=l(e.components);return n.createElement(d.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,d=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=l(a),m=r,h=u["".concat(d,".").concat(m)]||u[m]||c[m]||i;return a?n.createElement(h,o(o({ref:t},p),{},{components:a})):n.createElement(h,o({ref:t},p))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=u;var s={};for(var d in t)hasOwnProperty.call(t,d)&&(s[d]=t[d]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var l=2;l<i;l++)o[l]=a[l];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},28:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return s},contentTitle:function(){return d},metadata:function(){return l},toc:function(){return p},default:function(){return u}});var n=a(7462),r=a(3366),i=(a(7294),a(3905)),o=["components"],s={id:"managing-adapter",title:"Managing"},d=void 0,l={unversionedId:"contracts/adapters/configuration/managing-adapter",id:"contracts/adapters/configuration/managing-adapter",isDocsHomePage:!1,title:"Managing",description:"The Managing adapter handles the proposal creation, sponsorship and processing of a new adapter/extension including its initial configuration, and permissions.",source:"@site/docs/contracts/adapters/configuration/Managing.md",sourceDirName:"contracts/adapters/configuration",slug:"/contracts/adapters/configuration/managing-adapter",permalink:"/docs/contracts/adapters/configuration/managing-adapter",editUrl:"https://github.com/openlawteam/tribute-contracts/edit/docs/website/docs/contracts/adapters/configuration/Managing.md",tags:[],version:"current",frontMatter:{id:"managing-adapter",title:"Managing"},sidebar:"docs",previous:{title:"Configuration",permalink:"/docs/contracts/adapters/configuration/configuration-adapter"},next:{title:"Distribute",permalink:"/docs/contracts/adapters/distribution/distribute-adapter"}},p=[{value:"Workflow",id:"workflow",children:[]},{value:"Access Flags",id:"access-flags",children:[{value:"DaoRegistry",id:"daoregistry",children:[]}]},{value:"Dependencies",id:"dependencies",children:[{value:"DaoRegistry",id:"daoregistry-1",children:[]},{value:"Voting",id:"voting",children:[]}]},{value:"Structs",id:"structs",children:[{value:"ProposalDetails",id:"proposaldetails",children:[]}]},{value:"Storage",id:"storage",children:[{value:"proposals",id:"proposals",children:[]}]},{value:"Functions",id:"functions",children:[{value:"submitProposal",id:"submitproposal",children:[]},{value:"processProposal",id:"processproposal",children:[]}]},{value:"Events",id:"events",children:[{value:"AdapterRemoved",id:"adapterremoved",children:[]},{value:"AdapterAdded",id:"adapteradded",children:[]},{value:"ConfigurationUpdated",id:"configurationupdated",children:[]}]}],c={toc:p};function u(e){var t=e.components,a=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"The Managing adapter handles the proposal creation, sponsorship and processing of a new adapter/extension including its initial configuration, and permissions."),(0,i.kt)("p",null,"An adapter/extension can be added, removed or replaced in the DAO registry. In order to remove an adapter/extension one must pass the address 0x0 with the adapter/extension id that needs to be removed. To add a new adapter/extension one most provide the adapter/extension id, address and access flags. The address of the new adapter/extension can not be a reserved address, and the id must be a known id as defined in the ",(0,i.kt)("inlineCode",{parentName:"p"},"DaoConstants.sol"),". The replace adapter/extension operation removes the adapter/extension from the registry based on the id parameter, and also adds a new adapter/extension using the same id but with a new address."),(0,i.kt)("p",null,"The Managing adapter also allows one set custom ACL flags to adapters that need to communicate with different extensions."),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"It is important to indicate which operation type will be performed. Set 1 to ",(0,i.kt)("inlineCode",{parentName:"p"},"updateType")," when you are adding/removing an ",(0,i.kt)("inlineCode",{parentName:"p"},"Adapter"),", and set 2 when you are adding/removing an ",(0,i.kt)("inlineCode",{parentName:"p"},"Extension"),"."))),(0,i.kt)("h2",{id:"workflow"},"Workflow"),(0,i.kt)("p",null,"Submit a proposal and check:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"if caller is an active member"),(0,i.kt)("li",{parentName:"ul"},"if keys and values have equal length"),(0,i.kt)("li",{parentName:"ul"},"if adapter/extension address is valid"),(0,i.kt)("li",{parentName:"ul"},"if the access flags don't overflow"),(0,i.kt)("li",{parentName:"ul"},"if adapter/extension address is not reserved")),(0,i.kt)("p",null,"If all the requirements pass, then the proposal is subitted to registry and the adapter stores the proposal data."),(0,i.kt)("p",null,"Once the voting period ends, anyone can process the proposal. The proposal is processed only if:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"it has not been processed already"),(0,i.kt)("li",{parentName:"ul"},"the proposal has been sponsored"),(0,i.kt)("li",{parentName:"ul"},"the voting has passed"),(0,i.kt)("li",{parentName:"ul"},"the updateType is 1 (adapter) or 2 (extension)"),(0,i.kt)("li",{parentName:"ul"},"the extension ",(0,i.kt)("inlineCode",{parentName:"li"},"AclFlags"),", and ",(0,i.kt)("inlineCode",{parentName:"li"},"address")," are valid")),(0,i.kt)("h2",{id:"access-flags"},"Access Flags"),(0,i.kt)("h3",{id:"daoregistry"},"DaoRegistry"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"SUBMIT_PROPOSAL")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"REPLACE_ADAPTER")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ADD_EXTENSION")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"REMOVE_EXTENSION"))),(0,i.kt)("h2",{id:"dependencies"},"Dependencies"),(0,i.kt)("h3",{id:"daoregistry-1"},"DaoRegistry"),(0,i.kt)("h3",{id:"voting"},"Voting"),(0,i.kt)("h2",{id:"structs"},"Structs"),(0,i.kt)("h3",{id:"proposaldetails"},"ProposalDetails"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"adapterOrExtensionId"),": The id of the adapter/extension to add, remove or replace."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"adapterOrExtensionAddr"),": The contract address of the adapter/extension."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"flags"),": The DAO ACL for the new adapter."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"keys"),": The configuration keys for the adapter."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"values"),": The values to set for the adapter configuration."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"extensionAddresses"),": The list of extension addresses that the adapter interacts with."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"extensionAclFlags"),": The list of ACL flags that the adapter needs to interact with each extension.")),(0,i.kt)("h2",{id:"storage"},"Storage"),(0,i.kt)("h3",{id:"proposals"},"proposals"),(0,i.kt)("p",null,"All the proposals handled by the adapter per DAO."),(0,i.kt)("h2",{id:"functions"},"Functions"),(0,i.kt)("h3",{id:"submitproposal"},"submitProposal"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-solidity"},"    /**\n     * @notice Creates a proposal to replace, remove or add an adapter.\n     * @dev If the adapterAddress is equal to 0x0, the adapterId is removed from the registry if available.\n     * @dev If the adapterAddress is a reserved address, it reverts.\n     * @dev keys and value must have the same length.\n     * @dev proposalId can not be reused.\n     * @param dao The dao address.\n     * @param proposalId Tproposal details\n     * @param proposal The proposal details\n     * @param data Additional data to pass to the voting contract and identify the submitter\n     */\n    function submitProposal(\n        DaoRegistry dao,\n        bytes32 proposalId,\n        ProposalDetails calldata proposal,\n        bytes calldata data\n    ) external override onlyMember(dao) reentrancyGuard(dao)\n")),(0,i.kt)("h3",{id:"processproposal"},"processProposal"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-solidity"},"    /**\n     * @notice Processes a proposal that was sponsored.\n     * @dev Only members can process a proposal.\n     * @dev Only if the voting pass the proposal is processed.\n     * @dev Reverts when the adapter address is already in use and it is an adapter addition.\n     * @param dao The dao address.\n     * @param proposalId The guild kick proposal id.\n     */\n    function processProposal(DaoRegistry dao, bytes32 proposalId)\n        external\n        override\n        reentrancyGuard(dao)\n")),(0,i.kt)("h2",{id:"events"},"Events"),(0,i.kt)("h3",{id:"adapterremoved"},"AdapterRemoved"),(0,i.kt)("p",null,"When an adapter is removed from the regitry. Event emitted by the DAO Registry."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"event AdapterRemoved(bytes32 adapterId);"))),(0,i.kt)("h3",{id:"adapteradded"},"AdapterAdded"),(0,i.kt)("p",null,"When a new adapter is added to the registry. Event emitted by the DAO Registry."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"event AdapterAdded(bytes32 adapterId, address adapterAddress, uint256 flags);"))),(0,i.kt)("h3",{id:"configurationupdated"},"ConfigurationUpdated"),(0,i.kt)("p",null,"When a new configuration is stored in the registry. Event emitted by the DAO Registry."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"event ConfigurationUpdated(bytes32 key, uint256 value);"))))}u.isMDXComponent=!0}}]);