<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-220973515-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">ERC1271 | TributeDAO Framework</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://tributedao.com/docs/contracts/extensions/erc1271-extension"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="ERC1271 | TributeDAO Framework"><meta data-react-helmet="true" name="description" content="The ERC1271 extension allows DAOs to collectively sign messages and typed data through signatures. ERC1271 is a contract signature standard that enables smart contract wallets to behave like EOAs (externally owned accounts). Signatures are critical when interacting with various types of decentralized applications. Developers use signatures for authentication, meta-transactions, order books, and anything that requires delegated permission or proof of ownership of an address. ERC1271 has widespread adoption and is used in applications like Argent and Snapshot."><meta data-react-helmet="true" property="og:description" content="The ERC1271 extension allows DAOs to collectively sign messages and typed data through signatures. ERC1271 is a contract signature standard that enables smart contract wallets to behave like EOAs (externally owned accounts). Signatures are critical when interacting with various types of decentralized applications. Developers use signatures for authentication, meta-transactions, order books, and anything that requires delegated permission or proof of ownership of an address. ERC1271 has widespread adoption and is used in applications like Argent and Snapshot."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://tributedao.com/docs/contracts/extensions/erc1271-extension"><link data-react-helmet="true" rel="alternate" href="https://tributedao.com/docs/contracts/extensions/erc1271-extension" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://tributedao.com/docs/contracts/extensions/erc1271-extension" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.aa2eb1c7.css">
<link rel="preload" href="/assets/js/runtime~main.7a3114f4.js" as="script">
<link rel="preload" href="/assets/js/main.4d399bda.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"></a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist" href="#">Introduction</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/intro/overview-and-benefits">Overview &amp; Benefits</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Comparison</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Design Principles</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tutorials</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Contracts</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Core</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contracts/core/dao-registry">Registry</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contracts/core/dao-factory">Factory</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Extension</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contracts/extensions/bank-extension">Bank</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contracts/extensions/erc20-extension">ERC20</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contracts/extensions/nft-extension">NFT</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contracts/extensions/executor-extension">Executor</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/contracts/extensions/erc1271-extension">ERC1271</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contracts/extensions/erc1155-extension">ERC1155</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Adapter</a></li></ul></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/tutorial/dao/interacting">Tribute UI</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Subgraph</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>ERC1271</h1></header><p>The ERC1271 extension allows DAOs to collectively sign messages and typed data through signatures. ERC1271 is a contract signature standard that enables smart contract wallets to behave like EOAs (externally owned accounts). Signatures are critical when interacting with various types of decentralized applications. Developers use signatures for authentication, meta-transactions, order books, and anything that requires delegated permission or proof of ownership of an address. ERC1271 has widespread adoption and is used in applications like Argent and Snapshot.</p><p>In order to register a signature with the DAO, a member must submit a proposal in which they specify the signature message digest, the signature, and the magic value to return on success.</p><p>The message digest must be the hash of the message to sign. This can be a simple message hash, a personal signature (message with special prefix), or a typed data signature (message created using structured data).</p><p>The proposal enters the voting process.</p><p>If the vote passes, the extension returns the magic value when queried via the ERC1271 interface.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="access-flags"></a>Access Flags<a class="hash-link" href="#access-flags" title="Direct link to heading">#</a></h2><ul><li><code>SIGN</code>: right to store a signature into the contract <em>signatures</em> storage.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="structs"></a>Structs<a class="hash-link" href="#structs" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="daosignature"></a>DAOSignature<a class="hash-link" href="#daosignature" title="Direct link to heading">#</a></h3><ul><li><code>signatureProposals</code>: all signature proposals handled by each DAO.</li><li><code>SignatureDetails</code>:<ul><li><code>signature</code>: the signature associated with this proposal. May be used to encode other attributes for efficiency, since it is not a real signature and would just be wasted storage space.</li><li><code>msgHash</code>: the digest of the data to sign.</li><li><code>magicValue</code>: the value to return if a signature proposal has passed.</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="storage"></a>Storage<a class="hash-link" href="#storage" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="public-dao"></a>public dao<a class="hash-link" href="#public-dao" title="Direct link to heading">#</a></h3><p>The DAO address that this extension belongs to.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="public-initialized"></a>public initialized<a class="hash-link" href="#public-initialized" title="Direct link to heading">#</a></h3><p>Internally tracks deployment under ERC-1167 proxy pattern.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="public-signatures"></a>public signatures<a class="hash-link" href="#public-signatures" title="Direct link to heading">#</a></h3><p>Keeps track of all signatures provided through <code>sign</code> function, so they can be verified.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="dependencies"></a>Dependencies<a class="hash-link" href="#dependencies" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="daoregistry"></a>DaoRegistry<a class="hash-link" href="#daoregistry" title="Direct link to heading">#</a></h3><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="functions"></a>Functions<a class="hash-link" href="#functions" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="function-initialize"></a>function initialize<a class="hash-link" href="#function-initialize" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly solidity"><pre tabindex="0" class="prism-code language-solidity codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  * @notice Initialises the ERC1271 extension to be associated with a DAO</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  * @dev Can only be called once</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  * @param creator The DAO&#x27;s creator, who will be an initial member</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  */</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function initialize(DaoRegistry _dao, address creator) external</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="function-sign"></a>function sign<a class="hash-link" href="#function-sign" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly solidity"><pre tabindex="0" class="prism-code language-solidity codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @notice Registers a valid signature in the extension.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @dev Only adapters/extensions with `SIGN` ACL can call this function.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param permissionHash The digest of the data to be signed.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param signatureHash The hash of the signature.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param magicValue The value to be returned by the ERC1271 interface upon success.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    function sign(</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 permissionHash,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 signatureHash,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes4 magicValue</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ) public hasExtensionAccess(AclFlag.SIGN)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="function-isvalidsignature"></a>function isValidSignature<a class="hash-link" href="#function-isvalidsignature" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly solidity"><pre tabindex="0" class="prism-code language-solidity codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @notice Verifies if exists a signature based on the permissionHash, and checks if the provided signature matches the expected signatureHash.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param permissionHash The digest of the data to be signed.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param signature The signature in bytes to be encoded, hashed and verified.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @return The magic number in bytes4 in case the signature is valid, otherwise it reverts.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    function isValidSignature(bytes32 permissionHash, bytes memory signature)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        public</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        view</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        override</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        returns (bytes4)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    function isValidSignature(bytes32 permissionHash, bytes memory signature)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        public</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        view</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        override</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        returns (bytes4)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="events"></a>Events<a class="hash-link" href="#events" title="Direct link to heading">#</a></h2><ul><li>No events are emitted.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/openlawteam/tribute-contracts/edit/docs/website/docs/contracts/extensions/ERC1271.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/contracts/extensions/executor-extension"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Executor</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/contracts/extensions/erc1155-extension"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ERC1155 Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#access-flags" class="table-of-contents__link">Access Flags</a></li><li><a href="#structs" class="table-of-contents__link">Structs</a><ul><li><a href="#daosignature" class="table-of-contents__link">DAOSignature</a></li></ul></li><li><a href="#storage" class="table-of-contents__link">Storage</a><ul><li><a href="#public-dao" class="table-of-contents__link">public dao</a></li><li><a href="#public-initialized" class="table-of-contents__link">public initialized</a></li><li><a href="#public-signatures" class="table-of-contents__link">public signatures</a></li></ul></li><li><a href="#dependencies" class="table-of-contents__link">Dependencies</a><ul><li><a href="#daoregistry" class="table-of-contents__link">DaoRegistry</a></li></ul></li><li><a href="#functions" class="table-of-contents__link">Functions</a><ul><li><a href="#function-initialize" class="table-of-contents__link">function initialize</a></li><li><a href="#function-sign" class="table-of-contents__link">function sign</a></li><li><a href="#function-isvalidsignature" class="table-of-contents__link">function isValidSignature</a></li></ul></li><li><a href="#events" class="table-of-contents__link">Events</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.7a3114f4.js"></script>
<script src="/assets/js/main.4d399bda.js"></script>
</body>
</html>